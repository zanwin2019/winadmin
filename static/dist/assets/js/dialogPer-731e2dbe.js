import{u}from"./index-29446043.js";import{u as R}from"./index-21d650ff.js";import{d as M,_ as N,b as _,i as z,ag as r,o as B,O as I,P as l,a as c,V as s,U as g,T as h,n as O}from"./@vue-859b4330.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-fa427f68.js";import"./pinia-f5c09375.js";import"./vue-router-0ce8cd6d.js";import"./vue-i18n-a46d56de.js";import"./@intlify-d9393dcf.js";import"./vue-9a76c5f3.js";import"./js-cookie-edb2da2a.js";import"./@element-plus-e9b58552.js";import"./nprogress-28073a82.js";import"./axios-28bc18a3.js";import"./qs-42f07db3.js";import"./side-channel-99bfd094.js";import"./get-intrinsic-4a38020a.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-f7d0b240.js";import"./function-bind-61637ca6.js";import"./hasown-bc561cf0.js";import"./call-bind-6482c9b0.js";import"./set-function-length-9c361e89.js";import"./define-data-property-bf6c9733.js";import"./has-property-descriptors-58650a95.js";import"./gopd-e1d311d9.js";import"./object-inspect-70513235.js";import"./element-plus-9b914f77.js";import"./lodash-es-21c98b27.js";import"./@vueuse-8b13c3f4.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-816b3f93.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-72afddb3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-432baded.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-18559e02.js";const A={style:{color:"#fff"}},E={class:"dialog-footer"},K=M({__name:"dialogPer",emits:["handleQuery","PerhandleClose"],setup(U,{expose:f,emit:y}){const e=N({menuData:[],ownOrgData:[],checkStrict:!0,dialog:{isShowDialog:!1,type:"",title:"",submitTxt:""}}),n=_(),d=_(),p=y,k=()=>{R().getMenu().then(t=>{e.menuData=t.data})},v=()=>{var t={role_id:d.value};u().getRoleMenu(t).then(o=>{e.checkStrict=!0,O(()=>{var a;(a=n.value)==null||a.setCheckedKeys(o.data.map(i=>i.menu_id))})})},x=t=>{e.dialog.isShowDialog=!0,d.value=t.id,v(),e.dialog.title=`分配权限【${t.name}】`,e.dialog.submitTxt="提 交"},C=()=>{setTimeout(()=>{p("handleQuery"),p("PerhandleClose")},500),e.dialog.isShowDialog=!1},D=()=>{e.dialog.isShowDialog=!1},b=()=>{setTimeout(()=>{p("PerhandleClose")},500)},w=async()=>{var a;var t=(a=n.value)==null?void 0:a.getCheckedKeys(),o={role_id:d.value,menu_ids:t};await u().perRole(o),C()},S=t=>{var i;let o=!0;for(var a in t.children)if(((i=t.children[a].children)==null?void 0:i.length)??0>0){o=!1;break}return o?"penultimate-node":""};return z(async()=>{k()}),f({openDialog:x}),(t,o)=>{const a=r("ele-Edit"),i=r("el-icon"),T=r("el-tree"),m=r("el-button"),P=r("el-dialog");return B(),I(P,{modelValue:e.dialog.isShowDialog,"onUpdate:modelValue":o[0]||(o[0]=V=>e.dialog.isShowDialog=V),draggable:"",width:"600px",onClose:b},{header:l(()=>[c("div",A,[s(i,{size:"16",style:{"margin-right":"3px",display:"inline","vertical-align":"middle"}},{default:l(()=>[s(a)]),_:1}),c("span",null,g(e.dialog.title),1)])]),footer:l(()=>[c("span",E,[s(m,{onClick:D,size:"default"},{default:l(()=>[h("取 消")]),_:1}),s(m,{type:"primary",onClick:w,size:"default"},{default:l(()=>[h(g(e.dialog.submitTxt),1)]),_:1})])]),default:l(()=>[s(T,{ref_key:"treeRef",ref:n,data:e.menuData,"node-key":"id","show-checkbox":"","check-strictly":e.checkStrict,style:{"margin-left":"30px"},props:{children:"children",label:"name",class:S},"default-checked-keys":e.ownOrgData,"highlight-current":"","default-expand-all":""},null,8,["data","check-strictly","props","default-checked-keys"])]),_:1},8,["modelValue"])}}});const Pe=Q(K,[["__scopeId","data-v-65a6582d"]]);export{Pe as default};
