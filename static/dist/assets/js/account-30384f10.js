import{u as E,b as F}from"./vue-router-0ce8cd6d.js";import{v as $}from"./vue-i18n-a46d56de.js";import{d as b,s as B}from"./pinia-f5c09375.js";import{S as m,i as O,k as D,u as j,d as z,l as J,m as K,N as M}from"./index-21d73ac4.js";import{a as Q}from"./formatTime-29ac8c52.js";import{a as h}from"./element-plus-9b914f77.js";import{d as T,_ as H,j as L,ag as n,aq as Z,o as y,O as I,P as s,V as t,a as v,J as G,Q as W,U as X}from"./@vue-859b4330.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";import"./@intlify-d9393dcf.js";import"./vue-9a76c5f3.js";import"./js-cookie-edb2da2a.js";import"./@element-plus-e9b58552.js";import"./nprogress-28073a82.js";import"./axios-28bc18a3.js";import"./qs-42f07db3.js";import"./side-channel-99bfd094.js";import"./get-intrinsic-4a38020a.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-f7d0b240.js";import"./function-bind-61637ca6.js";import"./hasown-bc561cf0.js";import"./call-bind-6482c9b0.js";import"./set-function-length-9c361e89.js";import"./define-data-property-bf6c9733.js";import"./has-property-descriptors-58650a95.js";import"./gopd-e1d311d9.js";import"./object-inspect-70513235.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-18559e02.js";import"./lodash-es-21c98b27.js";import"./@vueuse-8b13c3f4.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-816b3f93.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-72afddb3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-432baded.js";const{ACCESS_TOKEN:S,REFRESH_TOKEN:C}=D(),ee=b("userAuth",{state:()=>({accessToken:m.get(S),refreshToken:m.get(C),errorMessage:""}),actions:{async login(_){const a=await O().login(_);return this.accessToken=a.data.access,this.refreshToken=a.data.refresh,m.set(S,a.data.access),m.set(C,a.data.refresh),!0}}}),oe=T({name:"loginAccount"}),se=T({...oe,setup(_){const{t:a}=$.useI18n(),k=j(),{themeConfig:x}=B(k),U=ee(),P=z(),u=E(),g=F(),e=H({isShowPassword:!1,ruleForm:{username:"admin",password:"1qaz!QAZ"},loading:{signIn:!1}}),A=L(()=>Q(new Date)),N=async()=>{try{if(e.loading.signIn=!0,!await U.login(e.ruleForm)){e.loading.signIn=!1;return}if(await P.$patch("setUserInfos"),x.value.isRequestRoutes){const o=await K();w(o)}else{const o=await J();w(o)}}finally{e.loading.signIn=!1}},w=r=>{var o,p,i,l;if(r)h.warning("抱歉，您没有登录权限"),m.clear();else{let c=A.value;(o=u.query)!=null&&o.redirect?g.push({path:(p=u.query)==null?void 0:p.redirect,query:Object.keys((i=u.query)==null?void 0:i.params).length>0?JSON.parse((l=u.query)==null?void 0:l.params):""}):g.push("/");const f=a("message.signInText");h.success(`${c}，${f}`),M.start()}e.loading.signIn=!1};return(r,o)=>{const p=n("ele-User"),i=n("el-icon"),l=n("el-input"),c=n("el-form-item"),f=n("ele-Unlock"),R=n("el-button"),V=n("el-form"),q=Z("waves");return y(),I(V,{size:"large",class:"login-content-form"},{default:s(()=>[t(c,{class:"login-animation1"},{default:s(()=>[t(l,{text:"",placeholder:r.$t("message.account.accountPlaceholder1"),modelValue:e.ruleForm.username,"onUpdate:modelValue":o[0]||(o[0]=d=>e.ruleForm.username=d),clearable:"",autocomplete:"off"},{prefix:s(()=>[t(i,{class:"el-input__icon"},{default:s(()=>[t(p)]),_:1})]),_:1},8,["placeholder","modelValue"])]),_:1}),t(c,{class:"login-animation2"},{default:s(()=>[t(l,{type:e.isShowPassword?"text":"password",placeholder:r.$t("message.account.accountPlaceholder2"),modelValue:e.ruleForm.password,"onUpdate:modelValue":o[2]||(o[2]=d=>e.ruleForm.password=d),autocomplete:"off"},{prefix:s(()=>[t(i,{class:"el-input__icon"},{default:s(()=>[t(f)]),_:1})]),suffix:s(()=>[v("i",{class:G(["iconfont el-input__icon login-content-password",e.isShowPassword?"icon-yincangmima":"icon-xianshimima"]),onClick:o[1]||(o[1]=d=>e.isShowPassword=!e.isShowPassword)},null,2)]),_:1},8,["type","placeholder","modelValue"])]),_:1}),t(c,{class:"login-animation4"},{default:s(()=>[W((y(),I(R,{type:"primary",class:"login-content-submit",round:"",onClick:N,loading:e.loading.signIn},{default:s(()=>[v("span",null,X(r.$t("message.account.accountBtnText")),1)]),_:1},8,["loading"])),[[q]])]),_:1})]),_:1})}}});const ze=Y(se,[["__scopeId","data-v-9430f30e"]]);export{ze as default};
