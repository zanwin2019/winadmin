import{d as w,_ as U,i as B,ag as i,aq as A,o as d,c as I,V as t,P as a,T as r,Q as R,O as p,U as F,u as H,a as b}from"./@vue-859b4330.js";const M={class:"notice-container"},Q=["innerHTML"],L={class:"dialog-footer"},$=w({name:"notice"}),O=w({...$,setup(j){const{removeHtml:v}=commonFunction(),e=U({loading:!1,noticeData:[],queryParams:{title:void 0,type:void 0},tableParams:{page:1,pageSize:20,total:0},editNoticeTitle:"",dialogVisible:!1,content:""});B(async()=>{c()});const c=async()=>{var l,u;e.loading=!0;var n=await getAPI(SysNoticeApi).apiSysNoticePageReceivedGet(e.queryParams.title,e.queryParams.type,e.tableParams.page,e.tableParams.pageSize);e.noticeData=((l=n.data.result)==null?void 0:l.items)??[],e.tableParams.total=(u=n.data.result)==null?void 0:u.total,e.loading=!1},P=()=>{e.queryParams.title=void 0,e.queryParams.type=void 0,c()},h=n=>{e.tableParams.pageSize=n,c()},N=n=>{e.tableParams.page=n,c()},S=async n=>{e.content=n.sysNotice.content,e.dialogVisible=!0,n.readStatus=1,await getAPI(SysNoticeApi).apiSysNoticeSetReadPost({id:n.sysNotice.id})},V=({row:n,rowIndex:l})=>n.readStatus===1?"info-row":"";return(n,l)=>{const u=i("el-input"),g=i("el-form-item"),y=i("el-option"),C=i("el-select"),m=i("el-button"),k=i("el-button-group"),x=i("el-form"),f=i("el-card"),s=i("el-table-column"),_=i("el-tag"),z=i("el-table"),q=i("el-pagination"),D=i("el-dialog"),T=A("loading");return d(),I("div",M,[t(f,{shadow:"hover","body-style":{paddingBottom:"0"}},{default:a(()=>[t(x,{model:e.queryParams,ref:"queryForm",inline:!0},{default:a(()=>[t(g,{label:"标题"},{default:a(()=>[t(u,{modelValue:e.queryParams.title,"onUpdate:modelValue":l[0]||(l[0]=o=>e.queryParams.title=o),placeholder:"标题",clearable:""},null,8,["modelValue"])]),_:1}),t(g,{label:"类型"},{default:a(()=>[t(C,{modelValue:e.queryParams.type,"onUpdate:modelValue":l[1]||(l[1]=o=>e.queryParams.type=o),placeholder:"类型",clearable:""},{default:a(()=>[t(y,{label:"通知",value:1}),t(y,{label:"公告",value:2})]),_:1},8,["modelValue"])]),_:1}),t(g,null,{default:a(()=>[t(k,null,{default:a(()=>[t(m,{type:"primary",icon:"ele-Search",onClick:c},{default:a(()=>[r(" 查询 ")]),_:1}),t(m,{icon:"ele-Refresh",onClick:P},{default:a(()=>[r(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(f,{class:"full-table",shadow:"hover",style:{"margin-top":"8px"}},{default:a(()=>[R((d(),p(z,{data:e.noticeData,style:{width:"100%"},border:"","row-class-name":V},{default:a(()=>[t(s,{type:"index",label:"序号",width:"55",align:"center"}),t(s,{prop:"sysNotice.title",label:"标题","header-align":"center","show-overflow-tooltip":""}),t(s,{prop:"sysNotice.content",label:"内容","header-align":"center","show-overflow-tooltip":""},{default:a(o=>[r(F(H(v)(o.row.sysNotice.content)),1)]),_:1}),t(s,{prop:"sysNotice.type",label:"类型",width:"100",align:"center","show-overflow-tooltip":""},{default:a(o=>[o.row.sysNotice.type===1?(d(),p(_,{key:0},{default:a(()=>[r(" 通知 ")]),_:1})):(d(),p(_,{key:1,type:"warning"},{default:a(()=>[r(" 公告 ")]),_:1}))]),_:1}),t(s,{prop:"sysNotice.createTime",label:"创建时间",align:"center","show-overflow-tooltip":""}),t(s,{prop:"readStatus",label:"阅读状态",width:"100",align:"center","show-overflow-tooltip":""},{default:a(o=>[o.row.readStatus===1?(d(),p(_,{key:0,type:"info"},{default:a(()=>[r(" 已读 ")]),_:1})):(d(),p(_,{key:1,type:"danger"},{default:a(()=>[r(" 未读 ")]),_:1}))]),_:1}),t(s,{prop:"sysNotice.publicUserName",label:"发布者",align:"center","show-overflow-tooltip":""}),t(s,{prop:"sysNotice.publicTime",label:"发布时间",align:"center","show-overflow-tooltip":""}),t(s,{label:"操作",width:"80",fixed:"right",align:"center","show-overflow-tooltip":""},{default:a(o=>[t(m,{icon:"ele-InfoFilled",size:"small",text:"",type:"primary",onClick:E=>S(o.row)},{default:a(()=>[r(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[T,e.loading]]),t(q,{currentPage:e.tableParams.page,"onUpdate:currentPage":l[2]||(l[2]=o=>e.tableParams.page=o),"page-size":e.tableParams.pageSize,"onUpdate:pageSize":l[3]||(l[3]=o=>e.tableParams.pageSize=o),total:e.tableParams.total,"page-sizes":[10,20,50,100],small:"",background:"",onSizeChange:h,onCurrentChange:N,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])]),_:1}),t(D,{modelValue:e.dialogVisible,"onUpdate:modelValue":l[5]||(l[5]=o=>e.dialogVisible=o),title:"消息详情",draggable:"",width:"769px"},{footer:a(()=>[b("span",L,[t(m,{type:"primary",onClick:l[4]||(l[4]=o=>e.dialogVisible=!1)},{default:a(()=>[r("确认")]),_:1})])]),default:a(()=>[b("p",{innerHTML:e.content},null,8,Q)]),_:1},8,["modelValue"])])}}});export{O as default};
